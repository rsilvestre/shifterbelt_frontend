{"version":3,"sources":["applications.es6"],"names":[],"mappings":"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","file":"applications.js","sourcesContent":["/**\n * Created by michaelsilvestre on 29/04/15\n */\n\nimport config from \"config\"\nlet utils = require(config.root + \"/lib/utils.js\");\nimport mongoose from \"mongoose\";\nlet Application = mongoose.model('Application');\n\n/**\n * Load\n */\n\nexports.load = (req, res, next, id) => {\n  var User = mongoose.model('User');\n\n  Application.load(id, req.user, (err, application) => {\n    if (err) {\n      return next(err);\n    }\n    if (!application) {\n      return next(new Error('not found'));\n    }\n    req.application = application;\n    next();\n  });\n};\n\n/**\n * List\n */\n\nexports.index = (req, res) => {\n  Application.list({ criteria: { \"users._id\": req.user._id } }, function(err, applications) {\n    if (err) return next(err);\n    Application.count().exec(function(err, count) {\n      res.render('applications/index', {\n        title: 'Your Applications',\n        applications: applications,\n        count: count\n      });\n    });\n  });\n};\n\n/**\n * New\n */\n\nexports.new = (req, res) => {\n  res.render('applications/new', {\n    title: 'New application',\n    application: new Application({})\n  });\n};\n\n/**\n * Create an application\n */\n\nexports.create = (req, res) => {\n  var application = new Application(req.body);\n  application.addUser(req.user, \"owner\", (err) => {\n    if (!err) {\n      req.flash('success', 'Successfully created application!');\n      return res.redirect('/applications/' + application._id);\n    }\n    console.log(err);\n    res.render('applications/new', {\n      title: 'New Applications',\n      application: application,\n      errors: utils.errors(err.errors || err)\n    });\n  });\n};\n\n/**\n * Show\n */\n\nexports.show = (req, res) => {\n  res.render('applications/show', {\n    title: req.application.name,\n    application: req.application\n  })\n};\n\n/**\n * Stats\n */\n\nexports.stats = (req, res) => {\n  res.render('applications/show', {\n    title: req.application.name,\n    application: req.application\n  })\n};\n"]}