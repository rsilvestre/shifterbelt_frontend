{"version":3,"sources":["../../../src/app/controllers/comments.js"],"names":[],"mappings":";;;;;;;AAKA,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,IAAI,KAAK,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;;;;;;AAMvC,OAAO,CAAC,IAAI,GAAG,UAAU,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE;AAC3C,MAAI,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;AAC1B,OAAK,CAAC,WAAW,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,UAAU,GAAG,EAAE,OAAO,EAAE;AACtE,QAAI,GAAG,EAAE;AACP,aAAO,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB;AACD,OAAG,CAAC,OAAO,GAAG,OAAO,CAAC;AACtB,QAAI,EAAE,CAAC;GACR,CAAC,CAAC;CACJ,CAAC;;;;;;AAMF,OAAO,CAAC,MAAM,GAAG,UAAU,GAAG,EAAE,GAAG,EAAE;AACnC,MAAI,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;AAC1B,MAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;AACpB,SAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtB,MAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,GAAG,CAAC,QAAQ,CAAC,YAAY,GAAE,OAAO,CAAC,EAAE,CAAC,CAAC;;AAElE,SAAO,CAAC,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,UAAU,GAAG,EAAE;AAChD,QAAI,GAAG,EAAE,OAAO,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAClC,OAAG,CAAC,QAAQ,CAAC,YAAY,GAAE,OAAO,CAAC,EAAE,CAAC,CAAC;GACxC,CAAC,CAAC;CACJ,CAAC;;;;;;AAMF,OAAO,CAAC,OAAO,GAAG,UAAU,GAAG,EAAE,GAAG,EAAE;AACpC,MAAI,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;AAC1B,SAAO,CAAC,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,EAAE,UAAU,GAAG,EAAE;AAC3D,QAAI,GAAG,EAAE;AACP,SAAG,CAAC,KAAK,CAAC,OAAO,EAAE,iCAAiC,CAAC,CAAC;KACvD,MAAM;AACL,SAAG,CAAC,KAAK,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC;KACtC;AACD,OAAG,CAAC,QAAQ,CAAC,YAAY,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC;GACzC,CAAC,CAAC;CACJ,CAAC","file":"comments.js","sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar mongoose = require('mongoose');\nvar utils = require('../../lib/utils');\n\n/**\n * Load comment\n */\n\nexports.load = function (req, res, next, id) {\n  var article = req.article;\n  utils.findByParam(article.comments, { id: id }, function (err, comment) {\n    if (err) {\n      return next(err);\n    }\n    req.comment = comment;\n    next();\n  });\n};\n\n/**\n * Create comment\n */\n\nexports.create = function (req, res) {\n  var article = req.article;\n  var user = req.user;\n  console.log(req.body);\n  if (!req.body.body) return res.redirect('/articles/'+ article.id);\n\n  article.addComment(user, req.body, function (err) {\n    if (err) return res.render('500');\n    res.redirect('/articles/'+ article.id);\n  });\n};\n\n/**\n * Delete comment\n */\n\nexports.destroy = function (req, res) {\n  var article = req.article;\n  article.removeComment(req.param('commentId'), function (err) {\n    if (err) {\n      req.flash('error', 'Oops! The comment was not found');\n    } else {\n      req.flash('info', 'Removed comment');\n    }\n    res.redirect('/articles/' + article.id);\n  });\n};\n"]}