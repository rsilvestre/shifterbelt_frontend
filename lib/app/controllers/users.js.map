{"version":3,"sources":["../../../src/app/controllers/users.js"],"names":[],"mappings":"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","file":"users.js","sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar mongoose = require('mongoose');\nvar User = mongoose.model('User');\nvar utils = require('../../lib/utils');\n\n/**\n * Load\n */\n\nexports.load = function (req, res, next, id) {\n  var options = {\n    criteria: { _id : id }\n  };\n  User.load(options, function (err, user) {\n    if (err) return next(err);\n    if (!user) return next(new Error('Failed to load User ' + id));\n    req.profile = user;\n    next();\n  });\n};\n\n/**\n * Create user\n */\nexports.create = function (req, res) {\n  var user = new User(req.body);\n  user.provider = 'local';\n  user.save(function (err) {\n    if (err) {\n      return res.render('users/signup', {\n        error: utils.errors(err.errors),\n        user: user,\n        title: 'Sign up'\n      });\n    }\n\n    // manually login the user once successfully signed up\n    req.logIn(user, function(err) {\n      if (err) {\n        req.flash('info', 'Sorry! We are not able to log you in!');\n      }\n      return res.redirect('/');\n    });\n  });\n};\n\n/**\n *  Show profile\n */\n\nexports.show = function (req, res) {\n  var user = req.profile;\n  res.render('users/show', {\n    title: user.name,\n    user: user\n  });\n};\n\nexports.signin = function (req, res) {};\n\n/**\n * Auth callback\n */\n\nexports.authCallback = login;\n\n/**\n * Show login form\n */\n\nexports.login = function (req, res) {\n  res.render('users/login', {\n    title: 'Login'\n  });\n};\n\n/**\n * Show sign up form\n */\n\nexports.signup = function (req, res) {\n  res.render('users/signup', {\n    title: 'Sign up',\n    user: new User()\n  });\n};\n\n/**\n * Logout\n */\n\nexports.logout = function (req, res) {\n  req.logout();\n  res.redirect('/login');\n};\n\n/**\n * Session\n */\n\nexports.session = login;\n\n/**\n * Login\n */\n\nfunction login (req, res) {\n  var redirectTo = req.session.returnTo ? req.session.returnTo : '/';\n  delete req.session.returnTo;\n  res.redirect(redirectTo);\n}\n"]}