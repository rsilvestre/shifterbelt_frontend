{"version":3,"sources":["../../../src/config/passport/facebook.js"],"names":[],"mappings":";;;;;;;AAKA,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,IAAI,gBAAgB,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC,QAAQ,CAAC;AAC7D,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC/B,IAAI,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;;;;;;AAMlC,MAAM,CAAC,OAAO,GAAG,IAAI,gBAAgB,CAAC;AAClC,UAAQ,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ;AAClC,cAAY,EAAE,MAAM,CAAC,QAAQ,CAAC,YAAY;AAC1C,aAAW,EAAE,MAAM,CAAC,QAAQ,CAAC,WAAW;CACzC,EACD,UAAS,WAAW,EAAE,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE;AACjD,MAAI,OAAO,GAAG;AACZ,YAAQ,EAAE,EAAE,aAAa,EAAE,OAAO,CAAC,EAAE,EAAE;GACxC,CAAC;AACF,MAAI,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE,IAAI,EAAE;AACtC,QAAI,GAAG,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;AAC1B,QAAI,CAAC,IAAI,EAAE;AACT,UAAI,GAAG,IAAI,IAAI,CAAC;AACd,YAAI,EAAE,OAAO,CAAC,WAAW;AACzB,aAAK,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK;AAC9B,gBAAQ,EAAE,OAAO,CAAC,QAAQ;AAC1B,gBAAQ,EAAE,UAAU;AACpB,gBAAQ,EAAE,OAAO,CAAC,KAAK;OACxB,CAAC,CAAC;AACH,UAAI,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE;AACvB,YAAI,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC1B,eAAO,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;OACxB,CAAC,CAAC;KACJ,MAAM;AACL,aAAO,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;KACxB;GACF,CAAC,CAAC;CACJ,CACF,CAAC","file":"facebook.js","sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar mongoose = require('mongoose');\nvar FacebookStrategy = require('passport-facebook').Strategy;\nvar config = require('config');\nvar User = mongoose.model('User');\n\n/**\n * Expose\n */\n\nmodule.exports = new FacebookStrategy({\n    clientID: config.facebook.clientID,\n    clientSecret: config.facebook.clientSecret,\n    callbackURL: config.facebook.callbackURL\n  },\n  function(accessToken, refreshToken, profile, done) {\n    var options = {\n      criteria: { 'facebook.id': profile.id }\n    };\n    User.load(options, function (err, user) {\n      if (err) return done(err);\n      if (!user) {\n        user = new User({\n          name: profile.displayName,\n          email: profile.emails[0].value,\n          username: profile.username,\n          provider: 'facebook',\n          facebook: profile._json\n        });\n        user.save(function (err) {\n          if (err) console.log(err);\n          return done(err, user);\n        });\n      } else {\n        return done(err, user);\n      }\n    });\n  }\n);\n"]}