{"version":3,"sources":["../../src/config/routes.js"],"names":[],"mappings":"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","file":"routes.js","sourcesContent":["\n/*!\n * Module dependencies.\n */\n\n// Note: We can require users, articles and other cotrollers because we have\n// set the NODE_PATH to be ./app/controllers (package.json # scripts # start)\n\nvar homepage = require('homepage');\nvar users = require('users');\nvar articles = require('articles');\nvar comments = require('comments');\nvar tags = require('tags');\nvar applications = require('applications');\nvar tariff = require('tariffs');\nvar auth = require('./middlewares/authorization');\n\n/**\n * Route middlewares\n */\n\nvar articleAuth = [auth.requiresLogin, auth.article.hasAuthorization];\nvar commentAuth = [auth.requiresLogin, auth.comment.hasAuthorization];\nvar applicationAuth = [auth.requiresLogin, auth.application.hasAuthorization];\n\n/**\n * Expose routes\n */\n\nmodule.exports = function (app, passport) {\n\n  // user routes\n  app.get('/login', users.login);\n  app.get('/signup', users.signup);\n  app.get('/logout', users.logout);\n  app.post('/users', users.create);\n  app.post('/users/session',\n    passport.authenticate('local', {\n      failureRedirect: '/login',\n      failureFlash: 'Invalid email or password.'\n    }), users.session);\n  app.get('/users/:userId', users.show);\n  app.get('/auth/facebook',\n    passport.authenticate('facebook', {\n      scope: [ 'email', 'user_about_me'],\n      failureRedirect: '/login'\n    }), users.signin);\n  app.get('/auth/facebook/callback',\n    passport.authenticate('facebook', {\n      failureRedirect: '/login'\n    }), users.authCallback);\n  app.get('/auth/github',\n    passport.authenticate('github', {\n      failureRedirect: '/login'\n    }), users.signin);\n  app.get('/auth/github/callback',\n    passport.authenticate('github', {\n      failureRedirect: '/login'\n    }), users.authCallback);\n  app.get('/auth/twitter',\n    passport.authenticate('twitter', {\n      failureRedirect: '/login'\n    }), users.signin);\n  app.get('/auth/twitter/callback',\n    passport.authenticate('twitter', {\n      failureRedirect: '/login'\n    }), users.authCallback);\n  app.get('/auth/google',\n    passport.authenticate('google', {\n      failureRedirect: '/login',\n      scope: [\n        'https://www.googleapis.com/auth/userinfo.profile',\n        'https://www.googleapis.com/auth/userinfo.email'\n      ]\n    }), users.signin);\n  app.get('/auth/google/callback',\n    passport.authenticate('google', {\n      failureRedirect: '/login'\n    }), users.authCallback);\n  app.get('/auth/linkedin',\n    passport.authenticate('linkedin', {\n      failureRedirect: '/login',\n      scope: [\n        'r_emailaddress'\n      ]\n    }), users.signin);\n  app.get('/auth/linkedin/callback',\n    passport.authenticate('linkedin', {\n      failureRedirect: '/login'\n    }), users.authCallback);\n\n  app.param('userId', users.load);\n\n  // article routes\n  app.param('id', articles.load);\n  app.get('/articles', articles.index);\n  app.get('/articles/new', auth.requiresLogin, articles.new);\n  app.post('/articles', auth.requiresLogin, articles.create);\n  app.get('/articles/:id', articles.show);\n  app.get('/articles/:id/edit', articleAuth, articles.edit);\n  app.put('/articles/:id', articleAuth, articles.update);\n  app.delete('/articles/:id', articleAuth, articles.destroy);\n\n  // application routes\n  app.param('applicationId', applications.load);\n  app.get('/applications', auth.requiresLogin, applications.index);\n  app.get('/applications/new', auth.requiresLogin, applications.new);\n  app.post('/applications', auth.requiresLogin, applications.create);\n  app.get('/applications/:applicationId/show', applicationAuth, applications.show);\n  app.get('/applications/:applicationId/stats', applicationAuth, applications.stats);\n  //app.get('/applications/:applicationId/edit', applicationAuth, applications.edit);\n  //app.put('/applications/:applicationId', applicationAuth, applications.update);\n  //app.delete('/applications/:applicationId', applicationAuth, applications.destroy);\n\n  // tariffs\n  app.param('tariffId', tariff.loadId);\n  app.param('tariffName', tariff.loadName);\n  app.get('/tariffs', auth.requiresLogin, tariff.index);\n  app.get('/tariffs/:tariffName/payment', auth.requiresLogin, tariff.payment);\n  app.post('/tariffs/:tariffName/create', auth.requiresLogin, tariff.create);\n\n  // home route\n  app.get('/', homepage.index);\n\n  // comment routes\n  app.param('commentId', comments.load);\n  app.post('/articles/:id/comments', auth.requiresLogin, comments.create);\n  app.get('/articles/:id/comments', auth.requiresLogin, comments.create);\n  app.delete('/articles/:id/comments/:commentId', commentAuth, comments.destroy);\n\n  // tag routes\n  app.get('/tags/:tag', tags.index);\n\n\n  /**\n   * Error handling\n   */\n\n  app.use(function (err, req, res, next) {\n    // treat as 404\n    if (err.message\n      && (~err.message.indexOf('not found')\n      || (~err.message.indexOf('Cast to ObjectId failed')))) {\n      return next();\n    }\n    console.error(err.stack);\n    // error page\n    res.status(500).render('500', { error: err.stack });\n  });\n\n  // assume 404 since no middleware responded\n  app.use(function (req, res, next) {\n    res.status(404).render('404', {\n      url: req.originalUrl,\n      error: 'Not found'\n    });\n  });\n};\n"]}